---
title: "Emmy Awards"
author: "Nick Cruickshank"
date: "9/25/2021"
output: 
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
```

![](https://deadline.com/wp-content/uploads/2020/07/emmys.jpg?w=681&h=383&crop=1)

# Introduction

This weeks [Tidy Tuesday Project](https://github.com/rfordatascience/tidytuesday/tree/master/data/2021/2021-09-21) comes from [emmys.com](https://www.emmys.com/awards/nominations/award-search). 

According to [Wikipedia](https://en.wikipedia.org/wiki/Emmy_Awards):
> An Emmy Award, or simply Emmy, is a trophy presented at one of the numerous annual American events or competitions that each recognize achievements in a particular sector of the television industry. The Emmy is considered one of the four major entertainment awards in the United States, the others being the Grammy (for music), the Oscar (Academy Award) (for film), and the Tony (for theatre). The two events that receive the most media coverage are the Primetime Emmy Awards and the Daytime Emmy Awards, which recognize outstanding work in American primetime and daytime entertainment programming, respectively.

# Data Analysis: Battle of the Streaming Services

```{r libraries}
# libraries
library(fontawesome)
library(ggtext)
library(hrbrthemes)
library(readr)
library(showtext)
library(tidyverse)
library(waffle)
```

```{r data}
# data
nominees <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-09-21/nominees.csv')
```

```{r}
# head
head(nominees)
```

```{r}
# values

## regexes
outstanding_series_regex <- "^Outstanding*\\s*(Series|Program|Special)$" # needs some work

## lists
top_streaming_services <- c("Netflix", "Hulu", "Prime Video",
                            "Disney+", "HBO", "Paramount+",
                            "Peacock", "Apple TV+")
```


```{r}
# tidy

## filter for categories like "Outstanding X Series"
emmy <- nominees %>%
  select(-starts_with("page")) %>%
  mutate(
    category2 = str_to_title(str_remove(category, " - [0-9]{4}")),
    title = str_to_title(title),
    distributor = case_when(
      distributor == "HBO Max" ~ "HBO",
      distributor %in% c("Amazon", "Amazon Instant Video") ~ "Prime Video",
      TRUE ~ distributor
    ),
    host = case_when(
      str_detect(title, "Jon Stewart") ~ "Jon Stewart",
      str_detect(title, "John Oliver") ~ "John Oliver",
      str_detect(title, "Colbert") ~ "Stephen Colbert",
      str_detect(title, "David Letterman") ~ "David Letterman",
      str_detect(title, "Jimmy Kimmel") ~ "Jimmy Kimmel"
    )
  )

shows_of_interest <- c("The Daily Show With Jon Stewart", "Last Week Tonight With John Oliver",
                       "The Late Show With Stephen Colbert", "The Colbert Report",
                       "Late Show With David Letterman", "Jimmy Kimmel Live")

hosts <- c("Jon Stewart", "John Oliver", "Stephen Colbert", "David Letterman", "Jimmy Kimmel")

host_categories <- emmy %>%
  filter(!(is.na(host))) %>%
  distinct(category) %>%
  pull(category)

category_winners <- emmy %>%
  filter(
    category %in% host_categories,
    type == "Winner"
  ) %>%
  mutate(winner = ifelse(host %in% hosts, host, "Other")) %>%
  distinct(category, winner)

df <- emmy %>%
  filter(category %in% host_categories) %>%
  mutate(host = ifelse(host %in% hosts, host, "Other")) %>%
  group_by(category) %>%
  dplyr::summarise(
    nominees = n(),
    `Jon Stewart` = sum(host == "Jon Stewart"),
    `John Oliver` = sum(host == "John Oliver"),
    `Stephen Colbert` = sum(host == "Stephen Colbert"),
    `David Letterman` = sum(host == "David Letterman"),
    `Jimmy Kimmel` = sum(host == "Jimmy Kimmel"),
    `Other` = sum(host == "Other")
  ) %>%
  ungroup() %>%
  pivot_longer(cols = c(-category, -nominees)) %>%
  left_join(category_winners, by = "category") %>%
  mutate(result = ifelse(name == winner & name != "Other", 1, 0)) %>%
  separate(category, into = c("category", "year"), sep = " - ")
``` 

# Plot

```{r Talk Show Waffles, fig.height=8, fig.width=12}
# plot
waffle <- df %>%
  group_by(year, name) %>%
  dplyr::summarise(
    Nomination = sum(value) - sum(result),
    Win = sum(result)
  ) %>%
  ungroup() %>%
  pivot_longer(cols = c(-year, -name), names_to = "result", values_to = "n") %>%
  mutate(
    fill = factor(paste0(name, " - ", result), levels = c(
      "Other - Win", "Other - Nomination",
      "Stephen Colbert - Win", "Stephen Colbert - Nomination",
      "Jon Stewart - Win", "Jon Stewart - Nomination",
      "John Oliver - Win", "John Oliver - Nomination",
      "Jimmy Kimmel - Win", "Jimmy Kimmel - Nomination",
      "David Letterman - Win", "David Letterman - Nomination"
    )),
    year = as.double(year)
  ) %>%
  filter(
    !(is.na(n)), !(is.na(year)),
    year != 2001
  )
```


```{r Talk Show Waffles, fig.height=8, fig.width=12}
colbert_win_color <- "#F99C5C"
colbert_nom_color <- "#CB9169"
stewart_win_color <- "#78EE9F"
stewart_nom_color <- "#7BC593"
oliver_win_color <- "#78EEE2"
oliver_nom_color <- "#7BC5BD"
kimmel_win_color <- "#F29996"
kimmel_nom_color <- "#C78F8E"
letter_win_color <- "#C796F2"
letter_nom_color <- "#AC8EC7"
other_color <- "#EFEFEF"
text_color <- "#F4E265"
background_color <- "#001397"

waffle %>%
  mutate(result = factor(result)) %>%
  filter(!str_detect(fill, "Other")) %>%
  ggplot(aes(fill = name, values = n)) + 
  geom_waffle(aes(color = result), size = 0.75, n_rows = 5, flip = TRUE,
              height = 0.9, width = 0.9) +
  facet_wrap(~ year, nrow = 1, strip.position = "bottom") + 
  scale_color_manual(values = c(background_color, text_color), guide = "none") +
  scale_fill_brewer(palette = "Dark2", name = NULL) +
  scale_x_discrete() + 
  scale_y_continuous(labels = function(x) x * 5, # make this multiplyer the same as n_rows
                     expand = c(0,0)) +
  coord_equal() + 
  labs(
    title = "Talk Show Host Emmy Nominations",
    subtitle = str_wrap("Highlighted cells represent wins."),
    caption = "Data Source: <b>emmys.com</b> |  Visualization: <b>N. Cruickshank</b> | #TidyTuesday"
  ) +
  theme_minimal() + 
  theme(
    legend.position = "top",
    plot.background = element_rect(fill = background_color),
    plot.title = element_text(color = text_color, hjust = 0.5, size = 24, face = "bold"),
    plot.subtitle = element_text(color = text_color, hjust = 0.5, size = 16, face = "italic"),
    plot.caption = element_textbox(color = text_color, hjust = 0.5, size = 12),
    legend.text = element_text(color = text_color),
    strip.text = element_text(color = text_color),
    axis.text.y = element_text(color = text_color),
    panel.grid = element_blank()
  )
```

