---
title: "20210824 - Lemurs"
author: "Nick Cruickshank"
date: "8/26/2021"
output: 
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
```

![Lemurs](https://images.unsplash.com/photo-1580855733764-084b90737008?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=967&q=80)

# Introduction

This weeks [Tidy Tuesday Project](https://github.com/rfordatascience/tidytuesday/tree/master/data/2021/2021-08-24) focuses on Lemurs! The data is made available by the [Duke Lemur Center](https://lemur.duke.edu/). 

## About Lemurs and the Duke Lemur Center

> The [Duke Lemur Center](https://lemur.duke.edu/) houses over 200 lemurs across 14 species – the most diverse population of lemurs on Earth, outside their native Madagascar.
>
> Lemurs are the most threatened group of mammals on the planet, and 95% of lemur species are at risk of extinction. Our mission is to learn everything we can about lemurs – because the more we learn, the better we can work to save them from extinction. They are endemic only to Madagascar, so it’s essentially a one-shot deal: once lemurs are gone from Madagascar, they are gone from the wild.
>
> By studying the variables that most affect their health, reproduction, and social dynamics, the Duke Lemur Center learns how to most effectively focus their conservation efforts. And the more we learn about lemurs, the better we can educate the public around the world about just how amazing these animals are, why they need to be protected, and how each and every one of us can make a difference in their survival.

## Article by Zehr et al 2014

> Here we present verified data for 3,627 individuals of 27 taxa in the form of a life history table containing summarized species values for variables relating to ancestry, reproduction, longevity, and body mass

> The current colony size is maintained at roughly 250 animals with 11 actively breeding species, and is the largest diverse collection of captive strepsirrhines worldwide. The endangered status of the species in the collection3, combined with regulations supporting their protection in the wild, make it extremely unlikely that a colony of this magnitude and diversity could ever be re-created.

> We have generated a life history table that provides species data and summary statistics for variables relating to adult, young-adult, and neonatal body mass, birth and breeding season, litter size, age at reproduction, longevity, infant mortality, [and] activity pattern

More information on the dataset can be found [here](https://www.nature.com/articles/sdata201419).

# Data Analysis

```{r libraries}
# libraries
library(ggtext)
library(glue)
library(forcats)
library(here)
library(png)
library(readr)
library(tidyverse)
```

```{r data}
# data
lemurs <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-08-24/lemur_data.csv')
```

```{r values}
# values
taxon_map <- tibble(
  taxon = c("ECOR", "LCAT", "VRUB", 
            "EFLA", "NPYG", "PCOQ", 
            "VVV", "MMUR", "DMAD"),
  common_name = c("Crowned Lemur", "Ring-Tailed Lemur", "Red Ruffed Lemur", 
                  "Blue-Eyed Black Lemur", "Pygmy Slow Loris", "Coquerel's Sifaka",
                  "Black-and-White Ruffed Lemur", "Gray Mouse Lemur", "Aye-Aye")
  )

key_taxons <- pull(taxon_map, taxon)

image_labels <- c(
  "Crowned Lemur" = glue("<img src='{here('2021', '20210817 - Lemurs', 'images', 'A - Crowned Lemur.png')}' width='80'/><br>*Crowned Lemur*"),
  "Ring-Tailed Lemur" = glue("<img src='{here('2021', '20210817 - Lemurs', 'images', 'B - Ring-Tailed Lemur.png')}' width='80'/><br>*Ring-Tailed Lemur*"), 
  "Red Ruffed Lemur" = glue("<img src='{here('2021', '20210817 - Lemurs', 'images', 'C - Red Ruffed Lemur.png')}' width='80'/><br>*Red Ruffed Lemur*"), 
  "Blue-Eyed Black Lemur" = glue("<img src='{here('2021', '20210817 - Lemurs', 'images', 'D - Blue-Eyed Black Lemur.png')}' width='80'/><br>*Blue-Eyed Black Lemur*"), 
  "Pygmy Slow Loris" = glue("<img src='{here('2021', '20210817 - Lemurs', 'images', 'E - Pygmy Slow Loris.png')}' width='80'/><br>*Pygmy Slow Loris*"), 
  "Coquerel's Sifaka" = glue("<img src='{here('2021', '20210817 - Lemurs', 'images', 'F - Coquerel's sifaka.png')}' width='80'/><br>*Coquerel's Sifaka*"),
  "Black-and-White Ruffed Lemur" = glue("<img src='{here('2021', '20210817 - Lemurs', 'images', 'G - Black-and-White Ruffed Lemur.png')}' width='80'/><br>*Black-and-White Ruffed Lemurr*"),
  "Gray Mouse Lemur" = glue("<img src='{here('2021', '20210817 - Lemurs', 'images', 'H - Gray Mouse Lemur.png')}' width='80'/><br>*Gray Mouse Lemur*"), 
  "Aye-Aye" = glue("<img src='{here('2021', '20210817 - Lemurs', 'images', 'I - Aye-Aye.png')}' width='80'/><br>*Aye-Ayer*")
  )
```

## Exploratory Data Analysis

### Are there any specimens which show up more than once in the dataset?

```{r EDA - Specimen ID Counts, fig.height=3, fig.width=10}
lemurs %>%
  count(dlc_id, birth_type, sort = TRUE) %>%
  ggplot(aes(fct_reorder(dlc_id, n), n)) + 
  geom_point() + 
  facet_wrap(~ birth_type, ncol = 3, scales = "free_x") + 
  theme_void()
```

It looks like many lemurs appear numerous times on the dataset. 

### Lifespan Expectancies

Average age at death by taxon (i.e., `age_at_death_y`)

```{r}
# geom_density_ridge() of age_at_death for each taxon
```

### Weight

```{r Lemur Growth Rates, fig.height=4, fig.width=16}
# weight by age and taxon
## grouping by age_at_wt_d is far too granular   (One = 17792, Not One = 9336)
## grouping by age_at_wt_wk is less granular     (One = 3209,  Not One = 7343)
## grouping by age_at_wt_mo is far less granular (One = 215,   Not One = 2884)
lemurs %>%
  inner_join(taxon_map, by = "taxon") %>%
  filter(
    age_category == "IJ", # there is a hard plateau in weight after this point
    sex != "ND"
  ) %>% 
  mutate(round_age_mo = round(age_at_wt_wk)) %>%
  group_by(taxon, common_name, sex, round_age_mo) %>%
  dplyr::summarise(
    n = n(),
    mean_weight = mean(weight_g)
  ) %>%
  ungroup()  %>%
  ggplot(aes(round_age_mo, mean_weight)) +
  geom_line(aes(color  = sex)) + 
  facet_wrap(~ common_name, ncol = 9, scales = "free") + 
  labs(
    title = "Growth Rate in Infantile or Juvenile Lemurs by Taxon"
  ) +
  theme(
    legend.position = "bottom",
    strip.text = element_textbox()
  )
```

When grouping by `round(age_at_wt_mo)`, it appears that most lemurs have a period of sharp growth during the first few years of life after which point they plateau for the remainder of their life. If the goal here is to plot growth rates, perhaps it would be better to focus on the baby and infantile periods of life.

- Need to find a way to include baby lemur images as axis labels  
   - I would also like it to pair up with the facets of growth rates so I can remove the `strip.text`.  
   - Maybe x-axis label is species, y axis is 1, label is ??? and size is static? What do I put there?  
      - Avg Weight at maturity?  
      - Avg Age at maturity?  
      - Both?

### Reproductive Behavior

What is the peak reproductive age for dams and sires?

Are there any times of year when lemurs are more likely to be born? What does this mean about the peak time of conception (i.e., `concep_month`)?

Is there any difference on whether the lemur was captive born (`birth_type == "CB`) or wild-born (`birth_type == "WB"`)?

Are there any differences in litter size by taxon (i.e., `litter_size`)?

Distribution of gestation time by taxon (i.e., `concep_month`).

### Where are most wildborn lemurs born?

Found in `birth_institution` column.

### Age at Death 

# Citations

Zehr, SM, Roach RG, Haring D, Taylor J, Cameron FH, Yoder AD. Life history profiles for 27 strepsirrhine primate taxa generated using captive data from the Duke Lemur Center. Sci. Data 1:140019 doi: 10.1038/sdata.2014.19 (2014).

Image taken by [Victoria Bragg](https://unsplash.com/@toritimephotos) and hosted on [Unsplash](https://unsplash.com/).