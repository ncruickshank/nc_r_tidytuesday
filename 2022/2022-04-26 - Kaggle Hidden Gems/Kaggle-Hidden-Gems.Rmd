---
title: "Kaggle Hidden Gems"
author: "Nick Cruickshank"
date: "4/30/2022"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
```

# Introduction

This weeks [Tidy Tuesday Project](https://github.com/rfordatascience/tidytuesday/tree/master/data/2022/2022-04-26) comes from the [Kaggle Notebooks of the Week - Hidden Gems](https://www.kaggle.com/datasets/headsortails/notebooks-of-the-week-hidden-gems?resource=download) project, which is celebrating it's 100th installment. 

## Data Dictionary

The file of interest is kaggle_hidden_gems.csv, containing the following columns:  
 - `vol` and `date`: The consecutive number of the Hidden Gems episode and when it was first published.  
 - `link_forum` and `link_twitter`: The hyperlinks to the Kaggle Forum post and Twitter post for the episode.  
 - `notebook` and `author`: The hyperlinks to the Notebook itself, as well as to the Kaggle profile of the author.  
 - `title`: The Notebook title as a string.  
 - `review`: My brief review of the Notebook.  
 - `author_name`: The name of the Notebook author as listed on their Kaggle profile at the time the episode was published.  
 - `author_twitter` and author_linkedin: The social media links of the author, if listed on their Kaggle profile.  
 - `notes`: Notes about special episodes.  

# Analysis

## Libraries and Data

```{r libraries}
# libraries
library(lubridate)
library(tidyverse)
library(tm) # for converting text into corpus
library(wordcloud)
library(wordcloud2)
```

```{r}
# data
hidden_gems <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-04-26/hidden_gems.csv')
```

## Tidy Data Set

This data set contains a lot of useful references for authorship and links to follow for each notebook. However, for the sake of visualizing the metadata, we don't care quite as much about that.  

```{r}
hg <- hidden_gems %>%
  select(date, author_kaggle, title, review)
```


## EDA

Are there any authors that show up a lot?

```{r}
count(hg, author_kaggle, sort = TRUE) %>%
  head(5)
```

## Visualization

### Ideas

When do the top five contributors show up in the data set?

```{r}
top_authors <- count(hg, author_kaggle, sort = TRUE) %>%
  head(5) %>%
  pull(author_kaggle)

# not the most illuminating idea
authorship_plot <- hg %>%
  mutate(
    author_category = ifelse(author_kaggle %in% top_authors, author_kaggle, "Other"),
    month = floor_date(date, unit = "month")
  ) %>%
  count(month, author_category) %>%
  ggplot(aes(month, n)) + 
  geom_bar(aes(fill = author_category), stat = "identity")
```

Word Cloud

Very useful guide found on [Toward Data Science](https://towardsdatascience.com/create-a-word-cloud-with-r-bde3e7422e8a) on how to make a Word Cloud.

## Selenium

Need to `install.packages("RSelenium")` and to have JAVA installed on the local machine (a useful tutorial for downloading JAVA is provided by [ProgrammingKnowledge](https://www.youtube.com/watch?v=IJ-PJbvJBGs)).

Selenium Tutorial provided by [Samer Hijjazi](https://www.youtube.com/watch?v=U1BrIPmhx10). 

```{r}
## selenium libraries
library(RSelenium)
library(wdman)
library(netstat)

## create driver
driver <- rsDriver(browser = "chrome",
                   chromever = '100.0.4896.60',
                   verbose = FALSE,
                   port = free_port())

## create client object
remDr <- driver$client
```

```{r}
kaggle <- hidden_gems$notebook[12]
tweet <- hidden_gems$author_twitter[12]

# open browser
remDr$open()

# go to kaggle link
remDr$navigate(tweet)

# finding elements

## twitter

### number of twitter followers
followers_element <- '//*[@id="react-root"]/div/div/div[2]/main/div/div/div/div[1]/div/div[2]/div/div/div/div/div[5]/div[2]'

webElem <- NULL
while(is.null(webElem)) {
  webElem <- tryCatch({remDr$findElement(using = "xpath", followers_element)},
                      error = function(e){NULL})
}

followers_xpath <- remDr$findElement(using = "xpath", followers_element)
followers <- followers_xpath$getElementText()

## kaggle
remDr$navigate(kaggle)

### notebook language
language_element <- '//*[@id="site-content"]/div[3]/div[3]/div/div[2]/div[1]/span'

#### wait for page to load
webElem <- NULL
while(is.null(webElem)) {
  webElem <- tryCatch({remDr$findElement(using = "xpath", language_element)},
                      error = function(e){NULL})
}

language_xpath <- remDr$findElement(using = "xpath", language_element)
language <- language_xpath$getElementText()

### views
views_xpath <- remDr$findElement(using = "xpath", '//*[@id="site-content"]/div[3]/div[3]/div/div[1]/span/span[2]')
views <- views_xpath$getElementText()

### upvotes
upvotes_xpath <- remDr$findElement(using = "xpath", '//*[@id="site-content"]/div[3]/div[3]/div/div[1]/div/div[1]/div/button[2]')
upvotes <- upvotes_xpath$getElementText()

### comments
comments_xpath <- remDr$findElement(using = "xpath", '//*[@id="site-content"]/div[3]/div[5]/div[1]/div/div/div/button[4]/div/span')
comments <- comments_xpath$getElementText()

paste0("Followers: ", followers, " || Views: ", views, " || Upvotes: ", upvotes, " || Comments: ", comments)

#remDr$close()
```

